C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(9,SPEED) BROWSE INCDIR(.\Include;E:\Keil_v5\C51\INC\STC)
                    - DEBUG OBJECTEXTEND PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <stc15.h>
   2          #include "ds1302.h"
   3          #include "oled.h"
   4          #include "uart.h"
   5          #include "fingerprint.h"
   6          
   7          #define FOSC 11059200L
   8          
   9          #define uchar unsigned char 
  10          #define uint unsigned int
  11          
  12          #define const_voice_short  40  
  13          #define const_led_long   120
  14          #define const_key_time  40   
  15          
  16          sbit memu = P0^3;
  17          sbit ret  = P0^6;
  18          sbit left   = P0^4;
  19          sbit right = P0^5;
  20          
  21          sbit touch = P0^7;
  22          sbit beep = P3^2;
  23          sbit red = P4^4;
  24          sbit green = P4^1;
  25          
  26          uchar ucKeySec = 0;   //‰∏Ä‰∫õÈúÄË¶ÅÂú®‰∏çÂêåÂáΩÊï∞‰πãÈó¥‰ΩøÁî®ÁöÑÊ†∏ÂøÉÂèòÈáèÔºåÂè™ËÉΩÁî®ÂÖ®Â±ÄÂèòÈáè
  27          uchar uiWrongCnt = 0;
  28          uchar uiPassCnt = 0;
  29          uchar WindowSec = 1;  //Á™óÂè£ÂèòÈáè
  30          uchar wd_update=1;  //Á™óÂè£Êï¥Â±èÊõ¥Êñ∞ÊòæÁ§∫Ê†áÂøóÔºåÊú¨ËäÇÊúÄÊ†∏ÂøÉÁöÑÂèòÈáè 
  31          
  32          bit part_1_2_update = 1;
  33          bit part_1_3_update = 1;
  34          bit part_2_2_update = 1;
  35          bit part_3_2_update = 1;
  36          bit part_4_2_update = 1;
  37          bit add_user = 0;
  38          bit add_admin = 0;
  39          bit identity_admin = 1;
  40          bit identity_user  = 0;
  41          bit delte_model    = 0;
  42          bit delte_allmodel = 0;
  43          uchar submemu_num  = 1;
  44          
  45          uint t = 0;
  46          int user_num = 1;
  47          uint  uiVoiceCnt = 0;  //‰∏Ä‰∫õÈúÄË¶ÅÂú®‰∏çÂêåÂáΩÊï∞‰πãÈó¥‰ΩøÁî®ÁöÑÊ†∏ÂøÉÂèòÈáèÔºåÂè™ËÉΩÁî®ÂÖ®Â±ÄÂèòÈáè
  48          fp xdata user_Ifo[301];
  49          //ÂàùÂßãÂåñÊó∂Èó¥Êó•ÊúüÊöÇÂ≠òÊï∞ÁªÑÔºåÁßí„ÄÅÂàÜ„ÄÅÊó∂„ÄÅÊó•„ÄÅÊúà„ÄÅÂë®„ÄÅÂπ¥ ÂàùÂÄº‰∏∫= 17Âπ¥6Êúà19Êó• Âë
             -®1 12:58:50
  50          uchar TimeData[7] ={20, 27, 16, 4, 7, 2, 17};
  51          
  52          void init_mcu();
  53          void delay(uint xms);
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 2   

  54          void init_peripheral();
  55          
  56          /*void MCU_Recevice_Date(unsigned char ucLength);
  57          void MCU_Synchronize_Time();
  58          void MCU_Communicate_PC();*/
  59          
  60          void T0_time();
  61          void key_scan();
  62          void key_service();
  63          
  64          void time_update();
  65          void OLED_Display();    //OLEDÊòæÁ§∫ÂáΩÊï∞
  66          void main_screen();     //‰∏ªÁïåÈù¢
  67          void memu_screen();   //ËèúÂçïÁïåÈù¢
  68          void ifo_screen();    //‰ø°ÊÅØÁïåÈù¢
  69          void sub_screen();    //Â≠êËèúÂçïÁïåÈù¢
  70          
  71          void main()
  72          {
  73   1        init_mcu();               //ÂàùÂßãÂåñÂçïÁâáÊú∫
  74   1        delay(200);               //Âª∂Êó∂
  75   1        init_peripheral();          //ÂàùÂßãÂåñÂ§ñËÆæ
  76   1        //MCU_Communicate_PC();       //ÂçïÁâáÊú∫‰∏éËÆ°ÁÆóÊú∫ÈÄö‰ø°
  77   1        //add_admin = 1;
  78   1        while(1)
  79   1        {
  80   2          key_service();          //ÊåâÈîÆÊúçÂä°ÂáΩÊï∞
  81   2          OLED_Display();         //OLEDÁïåÈù¢ÊòæÁ§∫ÂáΩÊï∞
  82   2          time_update();          //Êó∂Èó¥Êõ¥Êñ∞ÂáΩÊï∞
  83   2        }
  84   1      }
  85          
  86          void init_mcu()
  87          {
  88   1          beep=1; 
  89   1          TMOD=0x01;  
  90   1      
  91   1          TH0=0xf8;   
  92   1          TL0=0x2f;
  93   1      //  UART1_init_57600();
  94   1          UART2_init_57600();
  95   1      }
  96          
  97          void delay(uint xms)
  98          {
  99   1        uint i,j;
 100   1        for(i=0;i<xms+3;i++)
 101   1        {
 102   2          for(j=0;j<102;j++);
 103   2        }
 104   1      }
 105          
 106          void init_peripheral()
 107          {
 108   1        EA=1;     
 109   1        ET0=1;    
 110   1        TR0=1; 
 111   1        OLED_Init();          //ÂàùÂßãÂåñOLED  
 112   1        OLED_Clear();           //Ê∏ÖÂ±è
 113   1        //Set_DS1302_Time(DS1302_W_ADDR); //ÂÖàÂÜôÂÖ•Êó∂ÈíüÊó•ÂéÜÂØÑÂ≠òÂô®Ëµ∑ÂßãÂú∞ÂùÄÂÜçËÆæÁΩÆÊó∂ÈíüÊó•ÂéÜÂàùÂÄº
             -  
 114   1        Read_DS1302_Time(DS1302_R_ADDR);  //ÂÖàÂÜôÂÖ•Êó∂ÈíüÊó•ÂéÜÂØÑÂ≠òÂô®Ëµ∑ÂßãÂú∞ÂùÄÂÜçËØªÂá∫Êó∂ÈíüÊó•ÂéÜÂÜôÂÖ•
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 3   

             -Âà∞TimeDataÊï∞ÁªÑ‰∏≠
 115   1        //init_User_Ifo();
 116   1        //Set_User_Ifo();
 117   1        //add_admin = !(user_Ifo[0].isVaild);
 118   1      }
 119          void init_User_Ifo(void)
 120          {
 121   1        unsigned int i;
 122   1        for(i=0;i<301;i++)
 123   1        {
 124   2          user_Ifo[i].ID = 0;
 125   2          user_Ifo[i].isVaild = 0;
 126   2          user_Ifo[i].sec = 0;
 127   2          user_Ifo[i].min = 0;
 128   2          user_Ifo[i].hour = 0;
 129   2        }
 130   1      }
 131          void Set_User_Ifo(void)
 132          {
 133   1        unsigned int i;
 134   1        unsigned char* pTable;
 135   1        UART2_init_57600();
 136   1        pTable = FP_Get_ReadIndexTable(0);
 137   1        for(i = 0;i<256;i++)
 138   1        {
 139   2          user_Ifo[i].ID = i;
 140   2          user_Ifo[i].isVaild = (*(pTable + (i/8)) & (bit_num [(i%8)]));
 141   2        }
 142   1        UART2_init_57600();
 143   1        pTable = FP_Get_ReadIndexTable(1);
 144   1        for(i=256;i<301;i++)
 145   1        {
 146   2          user_Ifo[i].ID = i;
 147   2          user_Ifo[i].isVaild = (*(pTable + ((i/8)-32)) & (bit_num [(i%8)]));
 148   2        }
 149   1      }
 150          /*//ÂçïÁâáÊú∫Êé•Êî∂ËÆ°ÁÆóÊú∫ÁöÑÊï∞ÊçÆ
 151          void MCU_Recevice_Date(unsigned char ucLength)
 152          {
 153            unsigned char i;
 154            for(i=0;i<ucLength;i++)
 155              UART1_MCU_RECEVICE_BUFFER[i] = UART1_Receive_Byte();
 156          }
 157          
 158          //ÂçïÁâáÊú∫ÂêåÊ≠•ËÆ°ÁÆóÊú∫Êó∂Èó¥
 159          void MCU_Synchronize_Time()
 160          {
 161            unsigned char i;
 162            for(i=0;i<7;i++)
 163            {
 164              TimeData[i] = UART1_MCU_RECEVICE_BUFFER[i+2];
 165            }
 166            UART1_Send_Byte(0x01);
 167            UART1_Send_Byte(0x02);
 168            for(i=2;i<9;i++)
 169            {
 170              UART1_Send_Byte(TimeData[i-2]);
 171            }
 172            UART1_Send_Byte(0xFF);
 173          }
 174          //ÂçïÁâáÊú∫ÂíåËÆ°ÁÆóÊú∫ÈÄö‰ø°
 175          void MCU_Communicate_PC()
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 4   

 176          {
 177            MCU_Recevice_Date(10);
 178            if(UART1_MCU_RECEVICE_BUFFER[1] == 0x01)
 179            {
 180              IAP_CONTR = 0x60;
 181            }
 182            else if(UART1_MCU_RECEVICE_BUFFER[1] == 0x02)
 183            {
 184              MCU_Synchronize_Time();
 185              Set_DS1302_Time(DS1302_W_ADDR); //ÂÖàÂÜôÂÖ•Êó∂ÈíüÊó•ÂéÜÂØÑÂ≠òÂô®Ëµ∑ÂßãÂú∞ÂùÄÂÜçËÆæÁΩÆÊó∂ÈíüÊó•ÂéÜÂàùÂÄº
 186              add_admin = 1;
 187            }
 188            else
 189              Read_DS1302_Time(DS1302_R_ADDR);  //ÂÖàÂÜôÂÖ•Êó∂ÈíüÊó•ÂéÜÂØÑÂ≠òÂô®Ëµ∑ÂßãÂú∞ÂùÄÂÜçËØªÂá∫Êó∂ÈíüÊó•ÂéÜÂÜôÂÖ
             -•Âà∞TimeDataÊï∞ÁªÑ‰∏≠
 190          }*/
 191          
 192          //ÈîÆÁõòÊâ´ÊèèÂáΩÊï∞
 193          void key_scan()
 194          {
 195   1        //Â∏¶staticÁöÑÂ±ÄÈÉ®ÂèòÈáè
 196   1        static uint  uiKeyTimeCnt1=0;  
 197   1        static uchar ucKeyLock1=0;   
 198   1        static uint  uiKeyTimeCnt2=0; 
 199   1        static uchar ucKeyLock2=0;
 200   1        static uchar uiKeyTimeCnt3=0;
 201   1        static uchar ucKeyLock3=0;
 202   1        static uchar uiKeyTimeCnt4=0;
 203   1        static uchar ucKeyLock4=0;
 204   1      
 205   1      
 206   1          if(memu == 1)//IOÊòØÈ´òÁîµÂπ≥ÔºåËØ¥ÊòéÊåâÈîÆÊ≤°ÊúâË¢´Êåâ‰∏ãÔºåËøôÊó∂Ë¶ÅÂèäÊó∂Ê∏ÖÈõ∂‰∏Ä‰∫õÊ†áÂøó‰Ωç
 207   1          {
 208   2            ucKeyLock1 = 0; //ÊåâÈîÆËá™ÈîÅÊ†áÂøóÊ∏ÖÈõ∂
 209   2              uiKeyTimeCnt1 = 0;//ÊåâÈîÆÂéªÊäñÂä®Âª∂Êó∂ËÆ°Êï∞Âô®Ê∏ÖÈõ∂ÔºåÊ≠§Ë°åÈùûÂ∏∏Â∑ßÂ¶ôÔºåÊòØÊàëÂÆûÊàò‰∏≠Êë∏
             -Á¥¢Âá∫Êù•ÁöÑ„ÄÇ      
 210   2          }
 211   1          else if(ucKeyLock1 == 0)//ÊúâÊåâÈîÆÊåâ‰∏ãÔºå‰∏îÊòØÁ¨¨‰∏ÄÊ¨°Ë¢´Êåâ‰∏ã
 212   1          {
 213   2            uiKeyTimeCnt1 ++; //Á¥ØÂä†ÂÆöÊó∂‰∏≠Êñ≠Ê¨°Êï∞
 214   2            if(uiKeyTimeCnt1 > const_key_time)
 215   2            {
 216   3                uiKeyTimeCnt1 = 0; 
 217   3                ucKeyLock1 = 1;  //Ëá™ÈîÅÊåâÈîÆÁΩÆ‰Ωç,ÈÅøÂÖç‰∏ÄÁõ¥Ëß¶Âèë
 218   3                ucKeySec = 1;    //Ëß¶Âèë1Âè∑ÈîÆ
 219   3            }
 220   2          }
 221   1      
 222   1          if(ret == 1)
 223   1          {
 224   2            ucKeyLock2 = 0; 
 225   2              uiKeyTimeCnt2 = 0;
 226   2          }
 227   1          else if(ucKeyLock2 == 0)
 228   1          {
 229   2            uiKeyTimeCnt2 ++; 
 230   2            if(uiKeyTimeCnt2 > const_key_time)
 231   2            {
 232   3                uiKeyTimeCnt2 = 0;
 233   3                ucKeyLock2 = 1; 
 234   3                ucKeySec = 2;   
 235   3            }
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 5   

 236   2          }
 237   1      
 238   1          if(left == 1)//IOÊòØÈ´òÁîµÂπ≥ÔºåËØ¥ÊòéÊåâÈîÆÊ≤°ÊúâË¢´Êåâ‰∏ãÔºåËøôÊó∂Ë¶ÅÂèäÊó∂Ê∏ÖÈõ∂‰∏Ä‰∫õÊ†áÂøó‰Ωç
 239   1          {
 240   2            ucKeyLock3 = 0; //ÊåâÈîÆËá™ÈîÅÊ†áÂøóÊ∏ÖÈõ∂
 241   2              uiKeyTimeCnt3 = 0;//ÊåâÈîÆÂéªÊäñÂä®Âª∂Êó∂ËÆ°Êï∞Âô®Ê∏ÖÈõ∂ÔºåÊ≠§Ë°åÈùûÂ∏∏Â∑ßÂ¶ôÔºåÊòØÊàëÂÆûÊàò‰∏≠Êë∏
             -Á¥¢Âá∫Êù•ÁöÑ„ÄÇ      
 242   2          }
 243   1          else if(ucKeyLock3 == 0)//ÊúâÊåâÈîÆÊåâ‰∏ãÔºå‰∏îÊòØÁ¨¨‰∏ÄÊ¨°Ë¢´Êåâ‰∏ã
 244   1          {
 245   2            uiKeyTimeCnt3 ++; //Á¥ØÂä†ÂÆöÊó∂‰∏≠Êñ≠Ê¨°Êï∞
 246   2            if(uiKeyTimeCnt3 > const_key_time)
 247   2            {
 248   3                uiKeyTimeCnt3 = 0; 
 249   3                ucKeyLock3 = 1;  //Ëá™ÈîÅÊåâÈîÆÁΩÆ‰Ωç,ÈÅøÂÖç‰∏ÄÁõ¥Ëß¶Âèë
 250   3                ucKeySec = 3;    //Ëß¶Âèë3Âè∑ÈîÆ
 251   3            }
 252   2          }   
 253   1      
 254   1          if(right == 1)//IOÊòØÈ´òÁîµÂπ≥ÔºåËØ¥ÊòéÊåâÈîÆÊ≤°ÊúâË¢´Êåâ‰∏ãÔºåËøôÊó∂Ë¶ÅÂèäÊó∂Ê∏ÖÈõ∂‰∏Ä‰∫õÊ†áÂøó‰Ωç
 255   1          {
 256   2            ucKeyLock4 = 0; //ÊåâÈîÆËá™ÈîÅÊ†áÂøóÊ∏ÖÈõ∂
 257   2              uiKeyTimeCnt4 = 0;//ÊåâÈîÆÂéªÊäñÂä®Âª∂Êó∂ËÆ°Êï∞Âô®Ê∏ÖÈõ∂ÔºåÊ≠§Ë°åÈùûÂ∏∏Â∑ßÂ¶ôÔºåÊòØÊàëÂÆûÊàò‰∏≠Êë∏
             -Á¥¢Âá∫Êù•ÁöÑ„ÄÇ      
 258   2          }
 259   1          else if(ucKeyLock4 == 0)//ÊúâÊåâÈîÆÊåâ‰∏ãÔºå‰∏îÊòØÁ¨¨‰∏ÄÊ¨°Ë¢´Êåâ‰∏ã
 260   1          {
 261   2            uiKeyTimeCnt4 ++; //Á¥ØÂä†ÂÆöÊó∂‰∏≠Êñ≠Ê¨°Êï∞
 262   2            if(uiKeyTimeCnt4 > const_key_time)
 263   2            {
 264   3                uiKeyTimeCnt4 = 0; 
 265   3                ucKeyLock4 = 1;  //Ëá™ÈîÅÊåâÈîÆÁΩÆ‰Ωç,ÈÅøÂÖç‰∏ÄÁõ¥Ëß¶Âèë
 266   3                ucKeySec = 4;    //Ëß¶Âèë4Âè∑ÈîÆ
 267   3            }
 268   2          }
 269   1      }
 270          
 271          void key_service()
 272          {
 273   1        switch(ucKeySec) 
 274   1          {
 275   2            //ÂΩìmemuÈîÆË¢´Êåâ‰∏ã
 276   2            case 1:
 277   2                switch(WindowSec)
 278   2                {
 279   3                    //Âú®‰∏ªËèúÂçïÁ™óÂè£‰∏ã
 280   3                    case 1:
 281   3                         WindowSec = 2;     //ËøõÂÖ•ËèúÂçïÁ™óÂè£
 282   3                         wd_update = 1;     //ÂàáÊç¢Á™óÂè£ÈúÄË¶ÅÊï¥Â±èÊõ¥Êñ∞
 283   3                         part_2_2_update = 1; //ËèúÂçïÁ™óÂè£Á¨¨‰∫åË°åÊõ¥Êñ∞
 284   3                         break;
 285   3                    //Âú®ËèúÂçïÁ™óÂè£‰∏ã
 286   3                    case 2:
 287   3                     if(identity_admin && submemu_num < 4)
 288   3                     {
 289   4                      WindowSec = 5;      //ÂºπÂá∫ÂØπËØùÊ°Ü
 290   4                      wd_update = 1;
 291   4                     }
 292   3                     else
 293   3                     {
 294   4                      WindowSec = 3;
 295   4                      wd_update = 1;
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 6   

 296   4                      part_3_2_update = 1;
 297   4                     }
 298   3                     if(submemu_num == 4)
 299   3                     {
 300   4                      WindowSec = 5;
 301   4                          wd_update = 1;
 302   4                          identity_user = 1;
 303   4                     }
 304   3                     break;
 305   3                    //Âú®Â≠êËèúÂçïÁ™óÂè£‰∏ã
 306   3                    case 3:
 307   3                         switch(submemu_num)
 308   3                         {
 309   4                            case 1:
 310   4                                 WindowSec = 5;  //ËøõÂÖ•ÊèêÁ§∫Á™óÂè£
 311   4                                 wd_update = 1;
 312   4                                 add_user = 1;
 313   4                                 break;
 314   4                            case 2:
 315   4                                 WindowSec = 5;
 316   4                                 wd_update = 1;
 317   4                                 delte_model = 1;
 318   4                                 break;
 319   4                          case 3:
 320   4                               WindowSec = 5;
 321   4                               wd_update = 1;
 322   4                               delte_allmodel = 1;
 323   4                               break;
 324   4                          case 4:
 325   4                               WindowSec = 5;
 326   4                               wd_update = 1;
 327   4                               identity_user = 1;
 328   4                               break;
 329   4                         }
 330   3                           break;
 331   3                      //Âú®‰ø°ÊÅØÊèêÁ§∫Á™óÂè£‰∏ã
 332   3                      case 4:
 333   3                           WindowSec = 1;  //ËøîÂõû‰∏ªÁïåÈù¢Á™óÂè£
 334   3                           wd_update = 1;  
 335   3                           break;
 336   3                case 5:
 337   3                     WindowSec = 2;
 338   3                     wd_update = 1;
 339   3                     part_2_2_update = 1;
 340   3                     break;
 341   3                } 
 342   2                  uiVoiceCnt=const_voice_short; 
 343   2                  ucKeySec=0; 
 344   2                  break;
 345   2            //ÂΩìretÈîÆË¢´Êåâ‰∏ã        
 346   2            case 2:
 347   2                switch(WindowSec)
 348   2                {
 349   3                  //Âú®‰∏ªÁ™óÂè£‰∏ã
 350   3                  case 1:
 351   3                       WindowSec = 4;  //ËøõÂÖ•‰ø°ÊÅØÁ™óÂè£
 352   3                       wd_update = 1;
 353   3                       part_4_2_update = 1;
 354   3                       break;
 355   3                  //Âú®ËèúÂçïÁ™óÂè£‰∏ã
 356   3                  case 2:
 357   3                         WindowSec = 1;  //ËøîÂõû‰∏ªËèúÂçïÁ™óÂè£
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 7   

 358   3                         wd_update = 1;
 359   3                         submemu_num = 1;
 360   3                         break;
 361   3                  //Âú®Â≠êËèúÂçïÁ™óÂè£‰∏ã
 362   3                  case 3:
 363   3                       WindowSec = 2;  //ËøîÂõûËèúÂçïÁ™óÂè£
 364   3                       wd_update = 1;
 365   3                       user_num = 1;
 366   3                       identity_admin = 1;
 367   3                       identity_user = 0;
 368   3                       part_2_2_update = 1;
 369   3                       break;
 370   3                case 5:
 371   3                    WindowSec = 2;
 372   3                    wd_update = 1;
 373   3                    user_num = 1;
 374   3                    identity_user = 0;
 375   3                    part_2_2_update = 1;
 376   3                  break;
 377   3                }       
 378   2                  uiVoiceCnt=const_voice_short;
 379   2                  ucKeySec=0;
 380   2                  break;
 381   2            //ÂΩìleftÈîÆË¢´Êåâ‰∏ãÊó∂
 382   2            case 3:
 383   2                switch(WindowSec)
 384   2                {
 385   3                    case 1:add_admin = 1;
 386   3                         break;
 387   3                    //Âú®ËèúÂçïÁ™óÂè£‰∏ã
 388   3                    case 2:
 389   3                          submemu_num --;       //ËèúÂçïÁºñÂè∑Ëá™Âáè
 390   3                        if(submemu_num == 0)  //ËèúÂçïÁºñÂè∑ÂáèÂà∞0Êó∂Ëá™Âä®Ë∑≥ÂõûÊúÄÂêé‰∏Ä‰∏™ËèúÂçï
 391   3                        {
 392   4                            submemu_num = 5;
 393   4                        }
 394   3                        part_2_2_update = 1;  //ËèúÂçïÁ™óÂè£Á¨¨‰∫åË°åÊõ¥Êñ∞
 395   3                        break;
 396   3                    //Âú®Â≠êËèúÂçïÁ™óÂè£‰∏ã
 397   3                    case 3:
 398   3                         switch(submemu_num)
 399   3                         {
 400   4                           case 1:
 401   4                           case 2:
 402   4                          user_num --;
 403   4                                if(user_num == 0)
 404   4                                {
 405   5                                    user_num = 300;
 406   5                                }
 407   4                                part_3_2_update = 1;
 408   4                                break;
 409   4                           case 5:
 410   4                                user_num -= 2;
 411   4                                if(user_num == -1)
 412   4                                {
 413   5                                    user_num = 299;
 414   5                                }
 415   4                                part_3_2_update = 1;
 416   4                                break;                    
 417   4                         }
 418   3                         break;
 419   3                }
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 8   

 420   2                  uiVoiceCnt=const_voice_short;
 421   2                  ucKeySec=0;
 422   2                break;
 423   2            //ÂΩìrightÈîÆË¢´Êåâ‰∏ãÊó∂
 424   2            case 4:
 425   2                switch(WindowSec)
 426   2                {
 427   3                    //Âú®ËèúÂçïÁ™óÂè£‰∏ã
 428   3                    case 2:
 429   3                    submemu_num ++;
 430   3                    if(submemu_num == 6)
 431   3                    {
 432   4                      submemu_num = 1;
 433   4                    }
 434   3                    part_2_2_update = 1;
 435   3                    break;
 436   3                      case 3:
 437   3                            switch(submemu_num)
 438   3                         {
 439   4                           case 1:
 440   4                           case 2:
 441   4                          user_num ++;
 442   4                              if (user_num == 301)
 443   4                              {
 444   5                                  user_num = 1;
 445   5                              }
 446   4                              part_3_2_update = 1;
 447   4                              break;  
 448   4                           case 5:
 449   4                              user_num += 2;
 450   4                              if (user_num == 301)
 451   4                              {
 452   5                                  user_num = 1;
 453   5                              }
 454   4                              part_3_2_update = 1;
 455   4                              break;                  
 456   4                         }
 457   3                         break;
 458   3                    } 
 459   2                  uiVoiceCnt=const_voice_short;
 460   2              ucKeySec=0;
 461   2              break;
 462   2          }
 463   1      }
 464          
 465          void time_update()
 466          {
 467   1        t ++;
 468   1        if(t==120*500)
 469   1        {
 470   2          Read_DS1302_Time(DS1302_R_ADDR); //ÂÖàÂÜôÂÖ•Êó∂ÈíüÊó•ÂéÜÂØÑÂ≠òÂô®Ëµ∑ÂßãÂú∞ÂùÄÂÜçËØªÂá∫Êó∂ÈíüÊó•ÂéÜÂÜôÂÖ•
             -Âà∞TimeDataÊï∞ÁªÑ‰∏≠
 471   2          part_1_2_update = 1;
 472   2          if(TimeData[0]==00 && TimeData[2] == 0)
 473   2          {
 474   3            part_1_3_update = 1;
 475   3          }
 476   2        }
 477   1        
 478   1      }
 479          void T0_time() interrupt 1
 480          {
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 9   

 481   1        TF0 = 0; 
 482   1        TR0 = 0;
 483   1      
 484   1        key_scan(); 
 485   1      
 486   1        if(uiVoiceCnt!=0)
 487   1        {
 488   2           uiVoiceCnt--; 
 489   2           beep = 0;  
 490   2        }
 491   1        else
 492   1        {
 493   2           beep = 1; 
 494   2        }
 495   1        if(uiWrongCnt != 0)
 496   1        {
 497   2          uiWrongCnt --;
 498   2          red = 0;
 499   2        }
 500   1        else
 501   1        {
 502   2          red = 1;
 503   2        }
 504   1        if(uiPassCnt != 0)
 505   1        {
 506   2          uiPassCnt --;
 507   2          green = 0;
 508   2        }
 509   1        else
 510   1        {
 511   2          green = 1;
 512   2        }
 513   1        TH0 = 0xf8;   
 514   1        TL0 = 0x2f;
 515   1        TR0 = 1; 
 516   1      }
 517          
 518          
 519          void main_screen()
 520          {
 521   1        if(wd_update)
 522   1        {
 523   2          wd_update = 0;
 524   2          OLED_Clear();           //Ê∏ÖÂ±è
 525   2          //Á¨¨‰∏ÄË°åÁöÑÊòæÁ§∫ÂÜÖÂÆπ
 526   2          OLED_ShowChinese(18,0,8);//Êåá
 527   2          OLED_ShowChinese(36,0,9);//Á∫π
 528   2          OLED_ShowChinese(54,0,10);//ËÄÉ
 529   2          OLED_ShowChinese(72,0,11);//Âã§
 530   2          OLED_ShowChinese(90,0,12);//Âô®
 531   2      
 532   2          //Á¨¨‰∫åË°åÁöÑÊòæÁ§∫ÂÜÖÂÆπ:ÊòæÁ§∫Êó∂Èó¥
 533   2          OLED_ShowNum(25,2,TimeData[2]/10,1,16);
 534   2          OLED_ShowNum(33,2,TimeData[2]%10,1,16);
 535   2          OLED_ShowChar(40,2,':');
 536   2          OLED_ShowNum(49,2,TimeData[1]/10,1,16);
 537   2          OLED_ShowNum(57,2,TimeData[1]%10,1,16);
 538   2          OLED_ShowChar(64,2,':');
 539   2          OLED_ShowNum(73,2,TimeData[0]/10,1,16);
 540   2          OLED_ShowNum(81,2,TimeData[0]%10,1,16);
 541   2      
 542   2          //Á¨¨‰∏âË°åÁöÑÊòæÁ§∫ÂÜÖÂÆπÔºöÊòæÁ§∫Êó•ÊúüÂíåÊòüÊúü
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 10  

 543   2          OLED_ShowNum(10,4,TimeData[6]/10,1,8);
 544   2          OLED_ShowNum(19,4,TimeData[6]%10,1,8);
 545   2          OLED_ShowChar(28,4,'-');
 546   2          OLED_ShowNum(38,4,TimeData[4]/10,1,12);
 547   2          OLED_ShowNum(47,4,TimeData[4]%10,1,12);
 548   2          OLED_ShowChar(54,4,'-');
 549   2          OLED_ShowNum(64,4,TimeData[3]/10,1,12);
 550   2          OLED_ShowNum(73,4,TimeData[3]%10,1,12);
 551   2          OLED_ShowChinese(90,4,0);     //Âë®
 552   2          OLED_ShowChinese(108,4,TimeData[5]);//ÊòüÊúü
 553   2          
 554   2          //Á¨¨ÂõõË°åÁöÑÊòæÁ§∫ÂÜÖÂÆπÔºöÊòæÁ§∫ÈÄâÈ°π
 555   2          OLED_ShowChinese(0,6,13); //Ëèú
 556   2          OLED_ShowChinese(18,6,14);  //Âçï
 557   2          OLED_ShowChinese(90,6,15);  //‰ø°
 558   2          OLED_ShowChinese(108,6,16); //ÊÅØ 
 559   2        }
 560   1        if(part_1_2_update)
 561   1        {
 562   2          part_1_2_update = 0;
 563   2          //Á¨¨‰∫åË°åÁöÑÊòæÁ§∫ÂÜÖÂÆπ:ÊòæÁ§∫Êó∂Èó¥
 564   2          OLED_ShowNum(25,2,TimeData[2]/10,1,16);
 565   2          OLED_ShowNum(33,2,TimeData[2]%10,1,16);
 566   2          OLED_ShowChar(40,2,':');
 567   2          OLED_ShowNum(49,2,TimeData[1]/10,1,16);
 568   2          OLED_ShowNum(57,2,TimeData[1]%10,1,16);
 569   2          OLED_ShowChar(64,2,':');
 570   2          OLED_ShowNum(73,2,TimeData[0]/10,1,16);
 571   2          OLED_ShowNum(81,2,TimeData[0]%10,1,16);
 572   2        }
 573   1        if(part_1_3_update)
 574   1        {
 575   2          part_1_3_update = 0;
 576   2          //Á¨¨‰∏âË°åÁöÑÊòæÁ§∫ÂÜÖÂÆπÔºöÊòæÁ§∫Êó•ÊúüÂíåÊòüÊúü
 577   2          OLED_ShowNum(10,4,TimeData[6]/10,1,8);
 578   2          OLED_ShowNum(19,4,TimeData[6]%10,1,8);
 579   2          OLED_ShowChar(28,4,'-');
 580   2          OLED_ShowNum(38,4,TimeData[4]/10,1,12);
 581   2          OLED_ShowNum(47,4,TimeData[4]%10,1,12);
 582   2          OLED_ShowChar(54,4,'-');
 583   2          OLED_ShowNum(64,4,TimeData[3]/10,1,12);
 584   2          OLED_ShowNum(73,4,TimeData[3]%10,1,12);
 585   2          OLED_ShowChinese(90,4,0);     //Âë®
 586   2          OLED_ShowChinese(108,4,TimeData[5]);//ÊòüÊúü  
 587   2        }
 588   1      }
 589          
 590          void memu_screen()
 591          {
 592   1        if(wd_update)
 593   1        {
 594   2          wd_update = 0;
 595   2          OLED_Clear();
 596   2          //Ê∑ª(17) Âä†(18) Ê∏Ö(19) Á©∫(20) ÂºÄ(21) Âßã(22) Êâì(23) Âç°(24) Êü•(25) Áúã(26) Á°Æ(27) ÂÆö(28) Ëøî(29
             -) Âõû(30) ÁÆ°ÁêÜÂëò Ôºà31Ôºå32Ôºå33Ôºâ
 597   2          //line one
 598   2          OLED_ShowChinese(36,0,13);  //Ëèú
 599   2          OLED_ShowChinese(72,0,14);  //Âçï
 600   2      
 601   2      
 602   2          //line three
 603   2          OLED_ShowChinese(0,6,27); //Á°Æ
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 11  

 604   2          OLED_ShowChinese(18,6,28);  //ÂÆö
 605   2          OLED_ShowChar(50,6,'<');
 606   2          OLED_ShowChar(68,6,'>');
 607   2          OLED_ShowChinese(90,6,29);  //Ëøî
 608   2          OLED_ShowChinese(108,6,30); //Âõû
 609   2      
 610   2        }
 611   1        if(part_2_2_update)
 612   1        {
 613   2          part_2_2_update = 0;
 614   2      
 615   2          OLED_ShowNum(8,3,submemu_num,1,8);   //ÊòæÁ§∫ËèúÂçïÊï∞
 616   2          OLED_ShowChar(16,3,'.');
 617   2      
 618   2          switch(submemu_num)
 619   2          {
 620   3            case 1: OLED_ShowChinese(25,3,17);  //Ê∑ª
 621   3                OLED_ShowChinese(43,3,18);  //Âä†
 622   3                OLED_ShowChinese(61,3,8);   //Êåá
 623   3                OLED_ShowChinese(79,3,9);   //Á∫π
 624   3                break;
 625   3            case 2: OLED_ShowChinese(25,3,47);  //Âà†
 626   3                OLED_ShowChinese(43,3,48);  //Èô§
 627   3                OLED_ShowChinese(61,3,8);   //Êåá
 628   3                OLED_ShowChinese(79,3,9);   //Á∫π
 629   3                break;
 630   3            case 3:
 631   3                OLED_ShowChinese(25,3,19);  //Ê∏Ö
 632   3                OLED_ShowChinese(43,3,20);  //Á©∫
 633   3                OLED_ShowChinese(61,3,8);   //Êåá
 634   3                OLED_ShowChinese(79,3,9);   //Á∫π
 635   3                break;
 636   3            case 4:
 637   3                OLED_ShowChinese(25,3,21);  //ÂºÄ
 638   3                OLED_ShowChinese(43,3,22);  //Âßã
 639   3                OLED_ShowChinese(61,3,23);  //Êâì
 640   3                OLED_ShowChinese(79,3,24);  //Âç°
 641   3                break;
 642   3              case 5:
 643   3                OLED_ShowChinese(25,3,25);  //Êü•
 644   3                OLED_ShowChinese(43,3,26);  //Áúã
 645   3                OLED_ShowChinese(61,3,10);  //ËÄÉ
 646   3                OLED_ShowChinese(79,3,11);  //Âã§
 647   3                break;
 648   3          }
 649   2        } 
 650   1      }
 651          
 652          void ifo_screen()
 653          {
 654   1        if(wd_update)
 655   1        {
 656   2          wd_update = 0;
 657   2          OLED_Clear();
 658   2          //Âπø(34) ‰∏ú(35) Â∑•(36) ‰∏ö(37) Â§ß(38) Â≠¶(39)
 659   2          //line one
 660   2          OLED_ShowChinese(9,0,34);//Âπø
 661   2          OLED_ShowChinese(27,0,35);//‰∏ú
 662   2          OLED_ShowChinese(45,0,36);//Â∑•
 663   2          OLED_ShowChinese(63,0,37);//‰∏ö
 664   2          OLED_ShowChinese(81,0,38);//Â§ß
 665   2          OLED_ShowChinese(99,0,39);//Â≠¶
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 12  

 666   2      
 667   2          //Âê¥(40) Ëç£(41) Êù®(42) Ê£Æ(43) Êûó(44) Âå∫(45) Êôì(46)
 668   2          //line two
 669   2          OLED_ShowChinese(18,3,40);//Âê¥
 670   2          OLED_ShowChinese(54,3,41);//Ëç£
 671   2          OLED_ShowChinese(90,3,35);//‰∏ú
 672   2      
 673   2          delay(10000);
 674   2          OLED_ShowChinese(18,3,42);//Êù®
 675   2          OLED_ShowChinese(54,3,43);//Ê£Æ
 676   2          OLED_ShowChinese(90,3,44);//Êûó
 677   2      
 678   2          delay(10000);
 679   2          OLED_ShowChinese(18,3,45);//Âå∫
 680   2          OLED_ShowChinese(54,3,46);//Êôì
 681   2          OLED_ShowChinese(90,3,35);//‰∏ú
 682   2          delay(10000);
 683   2          OLED_ShowChinese(18,3,76);//Âà∂
 684   2          OLED_ShowChinese(54,3,79);//space
 685   2          OLED_ShowChinese(90,3,77);//‰Ωú
 686   2          delay(10000);
 687   2          OLED_ShowChinese(18,3,8);//Êåá
 688   2          OLED_ShowChinese(36,3,9);//Á∫π
 689   2          OLED_ShowChinese(54,3,74);//Êï∞
 690   2          OLED_ShowChinese(72,3,75);//Èáè
 691   2          OLED_ShowChinese(90,3,79);//space
 692   2          UART2_init_57600();
 693   2          //OLED_ShowNum(90,3,FP_Get_Templete_Num(),3,16);
 694   2          //line three
 695   2          OLED_ShowChinese(0,6,27); //Á°Æ
 696   2          OLED_ShowChinese(18,6,28);  //ÂÆö   
 697   2        }
 698   1      
 699   1      }
 700          
 701          //Â≠êËèúÂçïÁïåÈù¢
 702          void sub_screen()
 703          {
 704   1        if(wd_update)
 705   1        {
 706   2          wd_update = 0;
 707   2          OLED_Clear();
 708   2          switch(submemu_num)
 709   2          {
 710   3            case 1:
 711   3                //line one ËèúÂçïÂêç
 712   3                OLED_ShowChinese(27,0,17);//Ê∑ª
 713   3                OLED_ShowChinese(45,0,18);//Âä†
 714   3                OLED_ShowChinese(63,0,8);//Êåá
 715   3                OLED_ShowChinese(81,0,9);//Á∫π
 716   3                break;
 717   3            case 2:
 718   3                OLED_ShowChinese(27,0,47);//Âà†
 719   3                OLED_ShowChinese(45,0,48);//Èô§
 720   3                OLED_ShowChinese(63,0,8);//Êåá
 721   3                OLED_ShowChinese(81,0,9);//Á∫π
 722   3                break;
 723   3            case 3:
 724   3                OLED_ShowChinese(25,0,19);  //Ê∏Ö
 725   3                OLED_ShowChinese(43,0,20);  //Á©∫
 726   3                OLED_ShowChinese(63,0,8);   //Êåá
 727   3                OLED_ShowChinese(79,0,9);   //Á∫π
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 13  

 728   3                break;          
 729   3            case 4:
 730   3                OLED_ShowChinese(27,0,21);//ÂºÄ
 731   3                OLED_ShowChinese(45,0,22);//Âßã
 732   3                OLED_ShowChinese(63,0,23);//Êâì
 733   3                OLED_ShowChinese(81,0,24);//Âç°
 734   3                break;
 735   3            case 5:
 736   3                OLED_ShowChinese(27,0,25);//Êü•
 737   3                OLED_ShowChinese(45,0,26);//Áúã
 738   3                OLED_ShowChinese(63,0,10);//ËÄÉ
 739   3                OLED_ShowChinese(81,0,11);//Âã§ 
 740   3                break;        
 741   3          }
 742   2        }
 743   1      
 744   1        //line two ‰ø°ÊÅØÊü•Áúã
 745   1        if(part_3_2_update)
 746   1        {
 747   2          part_3_2_update = 0;
 748   2      
 749   2          switch(submemu_num)
 750   2          {
 751   3            //Âú®Ê∑ªÂä†ÊåáÁ∫πÂ≠êËèúÂçïÁïåÈù¢‰∏ã
 752   3            case 1:
 753   3                OLED_ShowNum(27,3,user_num/100,1,8);
 754   3                OLED_ShowNum(36,3,(user_num/10)%10,1,8);
 755   3                OLED_ShowNum(45,3,user_num%100,1,8);
 756   3                if(user_Ifo[user_num].isVaild)
 757   3                  OLED_ShowChinese(63,3,73);   //Â∑≤
 758   3                else
 759   3                  OLED_ShowChinese(63,3,78);   //Êú™
 760   3                OLED_ShowChinese(81,3,60);   //ÂΩï
 761   3                OLED_ShowChinese(99,3,61);   //ÂÖ•
 762   3      
 763   3                OLED_ShowChinese(0,6,27); //Á°Æ
 764   3                OLED_ShowChinese(18,6,28);  //ÂÆö
 765   3                OLED_ShowChar(50,6,'<');
 766   3                OLED_ShowChar(68,6,'>');
 767   3                OLED_ShowChinese(90,6,29);  //Âèñ
 768   3                OLED_ShowChinese(108,6,30); //Ê∂à
 769   3                break;
 770   3            //Âú®Âà†Èô§ÊåáÁ∫πÂ≠êËèúÂçïÁïåÈù¢‰∏ã
 771   3            case 2:
 772   3                OLED_ShowNum(27,3,user_num/100,1,8);
 773   3                OLED_ShowNum(36,3,(user_num/10)%10,1,8);
 774   3                OLED_ShowNum(45,3,user_num%100,1,8);
 775   3                //if(user_Ifo[user_num].isVaild)
 776   3                  //OLED_ShowChinese(63,3,73);   //Â∑≤
 777   3                //else
 778   3                  OLED_ShowChinese(63,3,78);   //Êú™
 779   3                OLED_ShowChinese(81,3,60);   //ÂΩï
 780   3                OLED_ShowChinese(99,3,61);   //ÂÖ•
 781   3      
 782   3                OLED_ShowChinese(0,6,27); //Á°Æ
 783   3                OLED_ShowChinese(18,6,28);  //ÂÆö
 784   3                OLED_ShowChar(50,6,'<');
 785   3                OLED_ShowChar(68,6,'>');
 786   3                OLED_ShowChinese(90,6,29);  //Ëøî
 787   3                OLED_ShowChinese(108,6,30); //Âõû
 788   3                break;
 789   3            //Âú®Ê∏ÖÁ©∫ÊåáÁ∫πÁïåÈù¢‰∏ã
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 14  

 790   3            case 3:
 791   3                OLED_ShowChinese(25,3,27);  //Á°Æ
 792   3                OLED_ShowChinese(43,3,50);  //ËÆ§
 793   3                OLED_ShowChinese(61,3,19);  //Ê∏Ö
 794   3                OLED_ShowChinese(79,3,20);  //Á©∫
 795   3      
 796   3                OLED_ShowChinese(0,6,27); //Á°Æ
 797   3                OLED_ShowChinese(18,6,28);  //ÂÆö
 798   3                OLED_ShowChinese(90,6,66);  //Âèñ
 799   3                OLED_ShowChinese(108,6,67); //Ê∂à
 800   3                break;
 801   3      
 802   3            //Âú®ÂºÄÂßãÊâìÂç°Â≠êËèúÂçïÁïåÈù¢‰∏ã
 803   3            case 4:
 804   3                OLED_ShowChinese(90,6,68);  //ÈÄÄ
 805   3                OLED_ShowChinese(108,6,69); //Âá∫
 806   3      
 807   3                //ÊòæÁ§∫Áî®Êà∑ÁºñÂè∑
 808   3                OLED_ShowNum(45,2,user_num/100,1,8);
 809   3                OLED_ShowNum(54,2,(user_num/10)%10,1,8);
 810   3                OLED_ShowNum(63,2,user_num%100,1,8);
 811   3                //ÊòæÁ§∫ÊâìÂç°Êó∂Èó¥
 812   3                OLED_ShowNum(25,4,TimeData[2]/10,1,16);
 813   3                OLED_ShowNum(33,4,TimeData[2]%10,1,16);
 814   3                OLED_ShowChar(40,4,':');
 815   3                OLED_ShowNum(49,4,TimeData[1]/10,1,16);
 816   3                OLED_ShowNum(57,4,TimeData[1]%10,1,16);
 817   3                OLED_ShowChar(64,4,':');
 818   3                OLED_ShowNum(73,4,TimeData[0]/10,1,16);
 819   3                OLED_ShowNum(81,4,TimeData[0]%10,1,16);
 820   3                delay(15000);
 821   3                WindowSec = 5;
 822   3                wd_update = 1;
 823   3                break;
 824   3            //Âú®Êü•ÁúãËÄÉÂã§Â≠êËèúÂçïÁïåÈù¢‰∏ã
 825   3            case 5:
 826   3                OLED_ShowNum(0,2,(user_num)/100,1,8);
 827   3                OLED_ShowNum(9,2,((user_num)/10)%10,1,8);
 828   3                OLED_ShowNum(18,2,(user_num)%100,1,8);
 829   3                
 830   3                OLED_ShowNum(36,2,TimeData[2]/10,1,16);
 831   3                OLED_ShowNum(45,2,TimeData[2]%10,1,16);
 832   3                OLED_ShowChar(54,2,':');
 833   3                OLED_ShowNum(63,2,TimeData[1]/10,1,16);
 834   3                OLED_ShowNum(72,2,TimeData[1]%10,1,16);
 835   3                OLED_ShowChar(81,2,':');
 836   3                OLED_ShowNum(90,2,TimeData[0]/10,1,16);
 837   3                OLED_ShowNum(99,2,TimeData[0]%10,1,16);
 838   3            
 839   3                //ÊòæÁ§∫ÊâìÂç°Êó∂Èó¥
 840   3                //OLED_ShowNum(36,2,user_Ifo[user_num].hour/10,1,16);
 841   3                //OLED_ShowNum(45,2,user_Ifo[user_num].hour%10,1,16);
 842   3                //OLED_ShowChar(54,2,':');
 843   3                //OLED_ShowNum(63,2,user_Ifo[user_num].min/10,1,16);
 844   3                //OLED_ShowNum(72,2,user_Ifo[user_num].min%10,1,16);
 845   3                //OLED_ShowChar(81,2,':');
 846   3                //OLED_ShowNum(90,2,user_Ifo[user_num].sec/10,1,16);
 847   3                //LED_ShowNum(99,2,user_Ifo[user_num].sec%10,1,16);
 848   3      
 849   3                OLED_ShowNum(0,4,(user_num+1)/100,1,8);
 850   3                OLED_ShowNum(9,4,((user_num+1)/10)%10,1,8);
 851   3                OLED_ShowNum(18,4,(user_num+1)%100,1,8);
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 15  

 852   3      
 853   3                //ÊòæÁ§∫ÊâìÂç°Êó∂Èó¥
 854   3                OLED_ShowNum(36,4,TimeData[2]/10,1,16);
 855   3                OLED_ShowNum(45,4,TimeData[2]%10,1,16);
 856   3                OLED_ShowChar(54,4,':');
 857   3                OLED_ShowNum(63,4,TimeData[1]/10,1,16);
 858   3                OLED_ShowNum(72,4,TimeData[1]%10,1,16);
 859   3                OLED_ShowChar(81,4,':');
 860   3                OLED_ShowNum(90,4,TimeData[0]/10,1,16);
 861   3                OLED_ShowNum(99,4,TimeData[0]%10,1,16);
 862   3      
 863   3                //ÊòæÁ§∫ÊâìÂç°Êó∂Èó¥
 864   3                //OLED_ShowNum(36,4,user_Ifo[user_num+1].hour/10,1,16);
 865   3                //OLED_ShowNum(45,4,user_Ifo[user_num+1].hour%10,1,16);
 866   3                //OLED_ShowChar(54,4,':');
 867   3                //OLED_ShowNum(63,4,user_Ifo[user_num+1].min/10,1,16);
 868   3                //OLED_ShowNum(72,4,user_Ifo[user_num+1].min%10,1,16);
 869   3                //OLED_ShowChar(81,4,':');
 870   3                ////OLED_ShowNum(90,4,user_Ifo[user_num+1].sec/10,1,16);
 871   3                //OLED_ShowNum(99,4,user_Ifo[user_num+1].sec%10,1,16);
 872   3                
 873   3                OLED_ShowChinese(0,6,64); //‰∏ä
 874   3                OLED_ShowChinese(18,6,65);  //‰º†
 875   3                OLED_ShowChar(50,6,'<');
 876   3                OLED_ShowChar(68,6,'>');
 877   3                OLED_ShowChinese(90,6,68);  //ÈÄÄ
 878   3                OLED_ShowChinese(108,6,69); //Âá∫
 879   3      
 880   3                break;
 881   3          }
 882   2        }
 883   1      
 884   1      }
 885          void dialog_screen()
 886          {
 887   1        if(wd_update)
 888   1        {
 889   2          wd_update = 0;
 890   2          OLED_Clear();
 891   2          switch(submemu_num)
 892   2          {
 893   3            case 1:
 894   3            case 2:
 895   3            case 3:
 896   3                if(add_admin)
 897   3                {
 898   4                  OLED_ShowChinese(9,0,49); //ËØ∑
 899   4                  OLED_ShowChinese(27,0,17);//Ê∑ª
 900   4                  OLED_ShowChinese(45,0,18);//Âä†
 901   4                  OLED_ShowChinese(63,0,31);//ÁÆ°
 902   4                  OLED_ShowChinese(81,0,32);//ÁêÜ
 903   4                  OLED_ShowChinese(99,0,33);//Âëò
 904   4      
 905   4                  UART2_init_57600();
 906   4                  //FP_add_new_user(0);
 907   4                  delay(10000);
 908   4                  //Set_User_Ifo();
 909   4                  OLED_ShowChinese(25,3,60);  //ÂΩï
 910   4                  OLED_ShowChinese(43,3,61);  //ÂÖ•
 911   4                  OLED_ShowChinese(61,3,63);  //Êàê
 912   4                  OLED_ShowChinese(79,3,72);  //Âäü
 913   4                  uiPassCnt = const_led_long;
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 16  

 914   4                  
 915   4                  OLED_ShowChinese(0,6,27); //Á°Æ
 916   4                  OLED_ShowChinese(18,6,28);  //ÂÆö
 917   4                  OLED_ShowChinese(90,6,29);  //Ëøî
 918   4                  OLED_ShowChinese(108,6,30); //Âõû
 919   4                  add_admin = 0;
 920   4                  break;
 921   4                }
 922   3                if(identity_admin)
 923   3                {
 924   4                  OLED_ShowChinese(9,0,49); //ËØ∑
 925   4                  OLED_ShowChinese(27,0,31);//ÁÆ°
 926   4                  OLED_ShowChinese(45,0,32);//ÁêÜ
 927   4                  OLED_ShowChinese(63,0,33);//Âëò
 928   4                  OLED_ShowChinese(81,0,27);//Á°Æ
 929   4                  OLED_ShowChinese(99,0,50);//ËÆ§
 930   4      
 931   4                  OLED_ShowChar(43,3,'.');  
 932   4                  OLED_ShowChar(52,3,'.');   
 933   4                  OLED_ShowChar(61,3,'.');
 934   4                  UART2_init_57600();
 935   4                  delay(10000);
 936   4                  if(1)//FP_Admin_Identity())
 937   4                  {
 938   5                    OLED_ShowChinese(43,3,63);  //Êàê
 939   5                    OLED_ShowChinese(61,3,72);  //Âäü
 940   5                    uiPassCnt = const_led_long;
 941   5                    WindowSec = 3;
 942   5                    wd_update = 1;
 943   5                    part_3_2_update = 1;
 944   5                    identity_admin = 0;
 945   5                  }
 946   4                  else
 947   4                  {
 948   5                    OLED_ShowChinese(43,3,70);  //Â§±
 949   5                    OLED_ShowChinese(61,3,71);  //Ë¥•
 950   5                    uiWrongCnt = const_led_long;
 951   5                    uiVoiceCnt = const_voice_short;
 952   5                    while(uiVoiceCnt == 0 && uiWrongCnt == 0);
 953   5                    WindowSec = 2;
 954   5                    wd_update = 2;
 955   5                    part_2_2_update = 1;
 956   5                  }
 957   4      
 958   4                  break;
 959   4                }
 960   3                if(add_user)
 961   3                {
 962   4                  OLED_ShowChinese(9,0,49); //ËØ∑
 963   4                  OLED_ShowChinese(27,0,51);//Ëß¶
 964   4                  OLED_ShowChinese(45,0,52);//Êë∏
 965   4                  OLED_ShowChinese(63,0,53);//‰º†
 966   4                  OLED_ShowChinese(81,0,54);//ÊÑü
 967   4                  OLED_ShowChinese(99,0,55);//Âô®
 968   4      
 969   4                  UART2_init_57600();
 970   4                  delay(10000);
 971   4                  //FP_add_new_user(user_num);
 972   4      
 973   4                  //Set_User_Ifo();
 974   4                  OLED_ShowChinese(25,3,60);  //ÂΩï
 975   4                  OLED_ShowChinese(43,3,61);  //ÂÖ•
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 17  

 976   4                  OLED_ShowChinese(61,3,63);  //Êàê
 977   4                  OLED_ShowChinese(79,3,72);  //Âäü
 978   4                  
 979   4                  OLED_ShowChinese(0,6,27); //Á°Æ
 980   4                  OLED_ShowChinese(18,6,28);  //ÂÆö
 981   4                  OLED_ShowChinese(90,6,29);  //Ëøî
 982   4                  OLED_ShowChinese(108,6,30); //Âõû
 983   4                  WindowSec = 3;
 984   4                  wd_update = 1;
 985   4                  part_3_2_update = 1;
 986   4                  add_user = 0;
 987   4                  break;
 988   4                }
 989   3                if(delte_model)
 990   3                {
 991   4                  UART2_init_57600();
 992   4                  FP_Cmd_Delete_Model(user_num);
 993   4                  Set_User_Ifo();
 994   4                  OLED_ShowChinese(45,0,73);//Â∑≤
 995   4                  OLED_ShowChinese(63,0,47);//Âà†
 996   4                  OLED_ShowChinese(81,0,48);//Èô§
 997   4                  OLED_ShowNum(50,3,user_num/100,1,8);
 998   4                  OLED_ShowNum(59,3,(user_num/10)%10,1,8);
 999   4                  OLED_ShowNum(68,3,user_num%100,1,8);
1000   4                  delay(10000);
1001   4                  WindowSec = 3;
1002   4                  wd_update = 1;
1003   4                  part_3_2_update = 1;
1004   4                  delte_model = 0;
1005   4                  break;
1006   4                }
1007   3                if(delte_allmodel)
1008   3                {
1009   4                  OLED_ShowChinese(25,0,19);  //Ê∏Ö
1010   4                  OLED_ShowChinese(43,0,20);  //Á©∫
1011   4                  OLED_ShowChinese(61,0,8);   //Êåá
1012   4                  OLED_ShowChinese(79,0,9);   //Á∫π
1013   4      
1014   4                  UART2_init_57600();
1015   4                  //FP_Cmd_Delete_All_Model();
1016   4                  //Set_User_Ifo();
1017   4                  delay(10000);
1018   4                  OLED_ShowChinese(43,3,73);  //Â∑≤
1019   4                  OLED_ShowChinese(61,3,19);  //Ê∏Ö
1020   4                  OLED_ShowChinese(79,3,20);  //Á©∫
1021   4                  
1022   4                  OLED_ShowChinese(0,6,27); //Á°Æ
1023   4                  OLED_ShowChinese(18,6,28);  //ÂÆö
1024   4                  OLED_ShowChinese(90,6,29);  //Ëøî
1025   4                  OLED_ShowChinese(108,6,30); //Âõû
1026   4                  add_admin = 1;
1027   4                  delte_allmodel = 0;
1028   4                  break;
1029   4                }
1030   3            case 4:   
1031   3                if(identity_user)
1032   3                {
1033   4                  int cnt = 0;
1034   4                  unsigned int num = 0;
1035   4                  OLED_ShowChinese(9,3,49); //ËØ∑
1036   4                  OLED_ShowChinese(27,3,51);//Ëß¶
1037   4                  OLED_ShowChinese(45,3,52);//Êë∏
C51 COMPILER V9.56.0.0   MAIN                                                              07/04/2017 16:27:30 PAGE 18  

1038   4                  OLED_ShowChinese(63,3,53);//‰º†
1039   4                  OLED_ShowChinese(81,3,54);//ÊÑü
1040   4                  OLED_ShowChinese(99,3,55);//Âô®
1041   4                  OLED_ShowChinese(90,6,68);  //ÈÄÄ
1042   4                  OLED_ShowChinese(108,6,69); //Âá∫
1043   4                  do{
1044   5                    time_update();
1045   5                    if(touch == 0)
1046   5                    {
1047   6                      UART2_init_57600();
1048   6                      num = FP_User_Identity();
1049   6                    }
1050   5                    key_scan();
1051   5                    if(ucKeySec == 2)
1052   5                    {
1053   6                      ucKeySec = 0;
1054   6                      num = 0;
1055   6                      WindowSec = 1;
1056   6                      wd_update = 1;
1057   6                      break;
1058   6                    }
1059   5                  }while(num == 0 || num ==-1);
1060   4                  if(num != 0)
1061   4                  {
1062   5                    user_num = num;
1063   5                    user_Ifo[user_num].sec = TimeData[0];
1064   5                    user_Ifo[user_num].min = TimeData[1];
1065   5                    user_Ifo[user_num].hour = TimeData[2];
1066   5                    uiPassCnt = const_led_long;
1067   5                    WindowSec = 3;
1068   5                    wd_update = 1;
1069   5                    part_3_2_update = 1;
1070   5                  }
1071   4                }
1072   3          }
1073   2        }
1074   1      }
1075          void OLED_Display()
1076          {
1077   1        switch(WindowSec)
1078   1        {
1079   2          case 1:main_screen();break;
1080   2          case 2:memu_screen();break;
1081   2          case 3:sub_screen();break;
1082   2          case 4:ifo_screen();break;
1083   2          case 5:dialog_screen();break;
1084   2        }
1085   1      }
*** WARNING C294 IN LINE 948 OF main.c: unreachable code


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3857    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   1806    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     37       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =     11    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
